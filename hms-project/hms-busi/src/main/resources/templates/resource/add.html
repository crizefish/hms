<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<title>博客详情</title>
<meta name="keywords" content="个人博客模板古典系列之――江南墨卷" />
<meta name="description" content="个人博客模板古典系列之――江南墨卷" />
<link href="../css/base.css" rel="stylesheet" />
<link href="../css/main.css" rel="stylesheet" />
<link href="../css/base.css" rel="stylesheet" />
<link href="../css/index.css" rel="stylesheet" />
<script type="text/javascript" src="../js/jquery/1.9/jquery.js"></script>
<script type="text/javascript" src="../js/jquery/ajaxfileupload.js"></script>
</head>
<body>
	<div id="wrapper">
		<header>
			  <div class="headtop"></div>
    <div class="contenttop">
     <div class="blank"></div>
    <div class="user" th:if="${session.SPRING_SECURITY_CONTEXT}==null">
    				 <ul> 
                     <li>
                      欢迎您，
	                     <a class="user_a" href="/login">请：登录</a>|
	                     <a class="user_a" href="/user/register">注册</a>
                     </li>   
                    </ul>  
</div> 
    <div class="user" th:if="${session.SPRING_SECURITY_CONTEXT}!=null">
    				 <ul> 
                     <li>
                      欢迎您，
	                     <a class="user_a" th:text="${session.SPRING_SECURITY_CONTEXT.authentication.principal.username} "></a>&nbsp;|
	                     <a class="user_a" href="/logout">注销</a>
                     </li>   
                    </ul>  
</div> 
 <div class="blank"></div>
      <div class="search f_r">
        <form action="/other/search" method="post" name="searchform" id="searchform">
          <input name="keyWord" id="keyWord" class="input_text" value="请输入关键字"  style="color: rgb(153, 153, 153);" onfocus="if(value=='请输入关键字'){this.style.color='#000';value=''}" onblur="if(value==''){this.style.color='#999';value='请输入关键字'}" type="text" />
          <input name="Submit" class="input_submit" value="搜索" type="button" id="search_button"/>
        </form>
      </div>
      <div class="blank"></div>
				<nav>
					<div class="navigation">
						<ul class="menu">
							<li><a th:href="@{'/news/'}">时事新闻</a></li>
							<li><a th:href="@{'/resource/'}">技术博客</a></li>
							<li><a th:href="@{'/resource/'}" style="color: silver;" >Java类库</a></li>
							<li><a th:href="@{'/note/'}">杂谈随记</a></li>
							<li><a th:href="@{'/message/'}">给我留言</a>
							</li>
						</ul>
					</div>
				</nav>


				<script type="text/javascript">
	// Navigation Menu
	$(function() {
		$(".menu ul").css({display: "none"}); // Opera Fix
		$(".menu li").hover(function(){
			$(this).find('ul:first').css({visibility: "visible",display: "none"}).slideDown("normal");
		},function(){
			$(this).find('ul:first').css({visibility: "hidden"});
		});
	});
	
	$("#search_button").click(function sub(){
		var keyWord = $("#keyWord").val();
		if(keyWord=="请输入关键字" || keyWord == ""){
			window.location.href="/other/index";
		}else{
			window.location.href="/other/search"+"?keyWord="+keyWord;
		}
	});
</script>
			</div>
		</header>

		<form id="resource" name="">

			<input type="hidden" id="current" th:attr="value=${resource.content}" />
			<input type="hidden" name="id" th:attr="value=${resource.id}" /> <input
				type="hidden" name="outLine" id="outLine"
				th:attr="value=${resource.outLine}" />

			<div style="width: 1034px; height: 35px; margin-left: 200px">
				类库名称：<input name="title" id="title" class="input_text" value="请输入名称"
					style="color: rgb(153, 153, 153); width: 430px"
					onfocus="if(value=='请输入名称'){this.style.color='#000';value=''}"
					onblur="if(value==''){this.style.color='#999';value='请输入名称'}"
					type="text" th:attr="value=${resource.title}" />
			</div>
			<div style="width: 1034px; height: 35px; margin-left: 200px">
				类库类型：<select th:attr="value=${resource.type}" class="input_text" >
					<option>文件处理</option>
					<option>数据处理</option>
					<option>工具类</option>
					<option>其他文件</option>				
				</select>
			</div>
			<div style="width: 1034px; height: 35px; margin-left: 200px">
				请录入标签：<input name="label" id="label" class="input_text" value="请输入标签"
					style="color: rgb(153, 153, 153); width: 430px"
					onfocus="if(value=='请输入标签'){this.style.color='#000';value=''}"
					onblur="if(value==''){this.style.color='#999';value='请输入标签'}"
					type="text" th:attr="value=${resource.label}" />
				（最多添加5个标签，多个标签之间用“,”分隔）
			</div>
			<div style="width: 1034px; height: 35px; margin-left: 200px">
					类库描述：
			</div>
		
			<div style="width: 1034px; height: 300px; margin-left: 200px">
				<textarea class="input_text" value="请输入类库描述"
					style="color: rgb(153, 153, 153); width: 600px;height: 290px"
					onfocus="if(value=='请输入类库描述'){this.style.color='#000';value=''}"
					onblur="if(value==''){this.style.color='#999';value='请输入类库描述'}"
					type="text" name="desc" th:attr="value=${resource.desc}" /> 
			</div>
			<div style="width: 1034px; height: 35px; margin-left: 200px">
				请选择java类库形式类型：
			</div>
			<div style="width: 1034px; height: 35px; margin-left: 200px">
				<input type="radio" name="fileType" value="class" id="class" checked="checked"/> 源码 
				<input type="radio" name="fileType" value="file" id="file" /> jar包 
			</div>
			<div style="width: 1034px; height: 35px; margin-left: 200px" id="class_div">
					请录入java源码 ：
								<input type="hidden" name="content" id="content" />
					
			</div>
			
			<div style="width: 1034px; height: 50px; margin-left: 200px" id="file_div" >
			<div>
					请选择jar包（或war包等）文件 ：
				</div>
								<div class="blank"></div>
				
			<div style="width: 1034px; height: 35px;">
					  <input type="file" id="fileUpload" name="file" style="color: transparent;"/>
					  <a id="fileName" color="blue" display="none"></a>
					  <a id="delete" color="red" display="none">删除</a>
			</div>
					</div>
		</form>
		<div class="jztop"></div>
		<div class="container">
			<div class="con_content">
				<script type="text/javascript" charset="utf-8"
					src="../ueditor/ueditor.config.js"></script>
				<script type="text/javascript" charset="utf-8"
					src="../ueditor/ueditor.all.min.js"> </script>
				<script type="text/javascript" charset="utf-8"
					src="../ueditor/lang/zh-cn/zh-cn.js"></script>

				<style type="text/css">
div {
	width: 100%;
}
</style>
				<div>
					<script id="editor" type="text/plain"
						style="width: 1024px; height: 500px;"></script>
				</div>

			</div>
			<div class="blank"></div>
		</div>
<div style="width: 1034px; height: 35px; margin-left: 200px">
				<input name="submit" class="input_submit"
					style="width: 50px;"
					value="  保 存" onclick="createBlogger()" id="create" />
					 <input
					name="button" class="input_submit"
					style="width: 50px;"
					value="  关 闭" onclick="location='/resource/'" />
			</div>
		<footer>
			<div class="footer">
				<div class="f_l">
					<p>
						想了解更多请联系我，邮箱地址：<a href="http://www.yangqq.com">103293443@qq.com</a>
					</p>
				</div>
				<div class="f_r textr">
					<p></p>
				</div>
			</div>
		</footer>

		<div>
			<input type="hidden" id="current" th:attr="value=${resource.content}" />
		</div>

	</div>

	<script type="text/javascript">
//实例化编辑器
//建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
var ue = UE.getEditor('editor');

$(function(){
	ue.addListener("ready", function () {
		var m = $("#current").val();
        // editor准备好之后才可以使用
        ue.setContent(m);
        $("#file_div").hide()

});
})



function createBlogger(){
	var content = UE.getEditor('editor').getContent();
	var text = UE.getEditor('editor').getContentTxt();
	if(content==''){
	alert("内容不能为空哦");	
	}else{
		var shortContent = text.substring(0,200);
		
		$("#outLine").val(shortContent);
		$("#content").val(content);
		$.ajax({
	        cache: true,
	        type: "POST",
	        url:"/resource/save",
	        data:$('#resource').serialize(),
	        async: false,
	        error: function(request) {
	            alert("Connection error");
	        },
	        success: function(data) {
	            if(data.msg=='1'){
	            	alert("添加成功")
	            	window.location.href="/resource/";
	            }else{
	            	alert(data.msg)
	            	alert(data.id)
	            }
	        }
	    });
	}
	}
	  $(":radio").click(function(){
	   var v = $(this).val();
	  if(v == "class"){
		  ue.setShow();
		  $("#file_div").hide()
		  $("#class_div").show()
	  }else{
		  ue.setHide();
		  $("#file_div").show()
		  $("#class_div").hide()
	  }
	  });

function fileUpload(){
	 $.ajaxFileUpload({
         url: '/resource/upload', 
         type: 'post',
         secureuri: false, //一般设置为false
         fileElementId: 'fileUpload', // 上传文件的id、name属性名
         dataType: 'text', //返回值类型，一般设置为json、application/json
         elementIds: '', //传递参数到服务器
         success: function(data, status){  
             alert(data);
         },
         error: function(data, status, e){ 
             alert(e);
         }
     });
	 $("#fileUpload").change(function() {
			fileUpload();
		});
}
$("#fileUpload").change(function() {
	fileUpload();
});
</script>
</body>
</html>
